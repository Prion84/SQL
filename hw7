7.1
'''Ваш менее опытный коллега не уверен, что его таблица retail действительно создалась и добавилась в базу данных. Напишите запрос, который создаст таблицу, если она еще не существует (IF NOT EXISTS), со следующими параметрами:

Название: retail
База: test
Столбцы:
- InvoiceNo – идентификатор заказа, строковое значение

- StockCode – идентификатор товара, строковое значение

- Description – описание товара, строковое значение

- Quantity – количество единиц товара, добавленных в корзину (особенность данных – значения могут быть отрицательными, 32 бита)

- InvoiceDate – дата и время создания заказа (транзакции), часовой пояс – 'Europe/London'

- UnitPrice – цена за единицу товара (особенность данных – значения могут быть отрицательными, точность – три знака после точки, 64 бита)

- CustomerID – идентификатор пользователя, целое положительное число, 32 бита.

- Country – страна, строковое значение. 

Движок: MergeTree
Сортировка: InvoiceDate, CustomerID
Hint: Decimal64
'''
CREATE TABLE IF NOT EXISTS test.retail ( 
    InvoiceNo String,
    StockCode String,
    Description String,    
    Quantity Int32,
    UnitPrice Decimal64(3),
    InvoiceDate DateTime('Europe/London'),
    CustomerID UInt32,
    Country String
    ) 

ENGINE = MergeTree
ORDER BY (InvoiceDate, CustomerID)


'''В следующих шагах используется default.retail – данные о транзакциях британского интернет-магазина в период с 1 декабря 2010 по 9 декабря 2011, где:

InvoiceNo – номер транзакции
StockCode – код товара
Description – описание товара
Quantity – количество единиц товара, добавленных в заказ
InvoiceDate – дата транзакции
UnitPrice – цена за единицу товара
CustomerID – id клиента
Country – страна, где проживает клиент'''
7.2'''Для начала посмотрите, в каких странах имеется наибольшее число уникальных пользователей. Постройте барчарт, где:

по оси x – страна
по оси y – число пользователей
В качестве ответа укажите число уникальных пользователей из Великобритании.

Note: запятые в Redash отделяют каждые три знака в числе (тысячные доли, миллионные и так далее). Например, 2,535,966 - это 2535966. В ответ надо писать число без запятых.
'''
SELECT COUNT(DISTINCT CustomerID) AS uniq_users,
       Country      
FROM default.retail
GROUP BY Country
