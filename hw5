5.4
'''Сначала оставьте только те объявления, в которых оценка на основе отзывов выше среднего, а число отзывов в месяц составляет строго меньше трёх. Затем отсортируйте по убыванию две колонки: сначала по числу отзывов в месяц, потом по оценке. В качестве ответа укажите id объявления из первой строки.

review_scores_rating – оценка на основе отзывов
reviews_per_month – число отзывов в месяц
id – идентификатор объявления
Таблица – listings. Наивысшие показатели = сортировка по убыванию.'''

SELECT 

id,
reviews_per_month  ,
toFloat32OrNull(review_scores_rating) as review_scores_rating1
FROM listings

WHERE
   (toFloat32OrNull(review_scores_rating) > (SELECT  AVG(toFloat32OrNull(review_scores_rating)) 
                FROM listings) ) and (reviews_per_month < 3)


ORDER BY reviews_per_month DESC,review_scores_rating1 DESC

LIMIT 100
